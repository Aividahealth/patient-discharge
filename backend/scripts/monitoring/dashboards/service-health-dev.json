{
  "displayName": "Service Health (Dev)",
  "mosaicLayout": {
    "columns": 12,
    "tiles": [
      {
        "xPos": 0,
        "yPos": 0,
        "width": 6,
        "height": 4,
        "widget": {
          "title": "Cloud Run request count",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "metric.type=\"run.googleapis.com/request_count\""
                  }
                },
                "plotType": "LINE"
              }
            ],
            "yAxis": { "label": "requests", "scale": "LINEAR" }
          }
        }
      },
      {
        "xPos": 6,
        "yPos": 0,
        "width": 6,
        "height": 4,
        "widget": {
          "title": "Cloud Run error rate (5xx)",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "timeSeriesQueryLanguage": "fetch run.googleapis.com/request_count | {ok: metric.response_code_class!=\"5xx\", err: metric.response_code_class=\"5xx\"} | align rate(5m) | group_by [resource.service_name], [sum(value.ok), sum(value.err)] | error_rate: div(sum_value_err, add(sum_value_ok, sum_value_err))"
                },
                "plotType": "LINE"
              }
            ],
            "yAxis": { "label": "ratio", "scale": "LINEAR" }
          }
        }
      },
      {
        "xPos": 0,
        "yPos": 4,
        "width": 6,
        "height": 4,
        "widget": {
          "title": "Pub/Sub unacked messages",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "metric.type=\"pubsub.googleapis.com/subscription/num_undelivered_messages\""
                  }
                },
                "plotType": "LINE"
              }
            ],
            "yAxis": { "label": "messages", "scale": "LINEAR" }
          }
        }
      },
      {
        "xPos": 6,
        "yPos": 4,
        "width": 6,
        "height": 4,
        "widget": {
          "title": "Cloud Functions invocations/errors",
          "xyChart": {
            "dataSets": [
              {
                "timeSeriesQuery": {
                  "timeSeriesFilter": {
                    "filter": "metric.type=\"cloudfunctions.googleapis.com/function/execution_count\""
                  }
                },
                "plotType": "LINE"
              }
            ],
            "yAxis": { "label": "count", "scale": "LINEAR" }
          }
        }
      }
    ]
  }
}


